# Logging

## Зачем

- Логирование в файл/консоль/ещё куда-то

Задача логирования - это сохранение информации о процессе выполнения кода, чтобы можно было восстановить ход событий, понять что и как происходило. Логирование должно отвечать на вопросы "почему что-то произошло/не произошло", давать возможность мапить процесс работы на код. Например, если приложение - это фоновая служба, которая обрабатывает запросы, то она вероятно не должна падать от ошибок при обработке, а кетчить их. Но при этом должна быть возможность понять что происходит во время обработки, успешна ли она и не летят ли ошибки. Если код берёт данные из базы, а потом фильтрует, то логи должны отвечать на вопрос "Где данные отфильтровали, по какому критерию"

Библиотеки для логирования обычно предоставляют интерфейс, который не зависит от того, куда логи должны попадать. Более того, дают возможность указывать сразу несколько направлений логирования.

> TODO: I2 про файловое логирование, ролинг файлов

## Либы для логирования

> TODO: I2

## Уровни логирования

Различные строчки в логах могут иметь разную важность и обычно важность обратно пропорциональна частоте появления строчки. Так например, строчки с ошибками обычно встречаются редко в процессе разработки и очень редко в процесса эксплуатации. С другой стороны есть строки, которые логируют просто информацию о происходящем, они встречаются намного чаще. Более того, обычно разработчики стремятся логировать как можно больше, чтобы получить полную картину. И тут появляются проблемы, начинается торг. С одной стороны есть желание залогировать всё, чтобы при чтении логов иметь максимально полный контекст. В другой стороны, картина логов в целом наполняется всё большим и большим количеством строчек в котором читать что-то становится труднее. Сложности добавлять также факт, что во время тестирования логов может казаться умеренное количество и разработчик вполне себе справится с их чтением. Но когда код запускают под нагрузкой и некоторые места начинают вызываться в 100 или 1000 раз чаще, то картина сильно меняется. Становится всё труднее находить те редкие строки с ошибками среди сотен строк с информацией.

Решением этой проблемы является уровни логирования. Уровень логирования - это параметр логгера, который указывает на то, насколько подробно нужно логировать. Выставляя определённый уровнеь логирования, логгер перестаёт логировать строки с более низким уровнем. Уровни могут быть разными для разных реализаций, но в целом можно выделить такие:

- Error - уровень логирования, который должен оставлять только ошибки
- Warning - аналогично, но с предупреждениями
- Info/Message - обычно, стандартный уровень логирования, который логирует основную полезную информацию, которая точно необходима будет
- Verbose - более детальный уровень, который раскрывает подробности выполнения отдельных шагов или дублирует уже ранее залогированные данные, но в более удобном для дебага виде
- Debug - максимально подробный уровень, который используется во время дебага, но почти никогда не нужен в продакшен среде

## Как залогировать сущность

- Пример с тем, что у студентов в реализации около 98% времени выполнения уходило на логирование
- Отдельный метод для логирования vs ToString vs "in place" методы

> TODO: I2

## Прочие подходы

Иногда можно встретить логирование уровня "Initialize component/service". Такие строчки могут быть полезны, но если читать их в отрыве от кода или не зная что выполнялось в коде ранее, очень трудно понять к чему они принадлежат. В качестве решения этой проблемы можно использовать префиксы для логов. Например, для определённого класса всегда вставлять префикс с его именем, чтобы было понятно, что инициализируется именно он.
